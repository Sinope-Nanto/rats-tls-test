# rats-tls运行流程
## 客户端
0. 在执行main函数之前，调用`librats_tls_init`函数，加载所有的实例。  
   
1. 建立socket连接
   
2. 调用`rats_tls_init`函数进行初始化  
函数调用流程  
`rats_tls_init(&conf, &handle)`
   + `rtls_crypto_wrapper_select()` 
   + `rtls_attester_select()`  
   + `rtls_verifier_select()`  
   + `rtls_tls_wrapper_select()`  
   + `rtls_core_generate_certificate()`  
      - `dice_generate_claims_buffer()`  
      - `dice_generate_evidence_buffer_with_tag()`  
      - `dice_generate_endorsements_buffer_with_tag()`  
      - `crypto_wrapper->opts->gen_cert()`  
      - `tls_wrapper->opts->use_privkey()`  
      - `tls_wrapper->opts->use_cert()`  
3. 调用`rats_tls_set_verification_callback`设置通过证书验证后的回调函数
   
4. 调用`rats_tls_negotiate`进行协商
		
通过调用`tls_wrapper->opts->negotiate`进行，此过程会调用`verify_certificate`验证服务端证书;

5. 成功建立通讯，此时可以通过`rats_tls_transmit`与`rats_tls_receive`向服务端传递信息或者接受从服务端传送的信息。